{"ast":null,"code":"function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n//==========================================================onPageLoadの定義\nfunction onPageLoad(controller_and_actions, callback) {\n  document.addEventListener('turbolinks:load', function () {\n    var conditions = regularize(controller_and_actions);\n\n    if (!conditions) {\n      console.error('[onPageLoad] Unexpected arguments!');\n      return;\n    }\n\n    conditions.forEach(function (a_controller_and_action) {\n      var _a_controller_and_act = a_controller_and_action.split('#'),\n          _a_controller_and_act2 = _slicedToArray(_a_controller_and_act, 2),\n          controller = _a_controller_and_act2[0],\n          action = _a_controller_and_act2[1];\n\n      if (isOnPage(controller, action)) {\n        callback();\n      }\n    });\n  });\n}\n\nfunction regularize(controller_and_actions) {\n  if (typeof controller_and_actions == 'string') {\n    return [controller_and_actions];\n  } else if (Object.prototype.toString.call(controller_and_actions).includes('Array') //controller_and_actions.isArray()\n  ) {\n      return controller_and_actions;\n    } else {\n    return null;\n  }\n}\n\nfunction isOnPage(controller, action) {\n  var selector = \"body[data-controller='\".concat(controller, \"']\");\n\n  if (!!action) {\n    selector += \"[data-action='\".concat(action, \"']\");\n  }\n\n  ;\n  return document.querySelectorAll(selector).length > 0;\n}\n\nfunction setPreviewImage(files) {\n  document.querySelectorAll('.previewImage').forEach(function (i) {\n    i.parentNode.removeChild(i);\n  });\n\n  for (var i = 0; i < files.length; i++) {\n    var file = files[i];\n    var blobUrl = window.URL.createObjectURL(file);\n    var img = document.createElement('img');\n    img.src = blobUrl;\n    img.classList.add('previewImage'); // document.body.appendChild(img);\n\n    dragArea.appendChild(img);\n  }\n} //=============================================================\n\n\nonPageLoad(['articles#new', 'articles#edit'], function () {\n  var fileField = document.getElementById('article_images');\n  var dragArea = document.getElementById('dragArea');\n  var dt = new DataTransfer(); //iOS,IEでは不可能.\n\n  var clearImagesButton = document.getElementById('clearImagesButton');\n  fileField.addEventListener('change', function (e) {\n    setPreviewImage(e.target.files);\n  });\n  dragArea.addEventListener('dragover', function (e) {\n    e.preventDefault();\n    e.target.style.backgroundColor = 'rgb(154, 154, 154)';\n  });\n  dragArea.addEventListener('dragleave', function (e) {\n    e.target.style.backgroundColor = 'rgb(231, 231, 231)';\n  });\n  dragArea.addEventListener('drop', function (e) {\n    if (dt.files.length >= 3) {\n      clearImagesButton.style.display = 'inline-block';\n      return;\n    }\n\n    e.preventDefault();\n    e.target.style.backgroundColor = 'rgb(231, 231, 231)';\n    clearImagesButton.style.display = 'inline-block';\n    dt.items.add(e.dataTransfer.files[0]);\n    fileField.files = dt.files;\n    setPreviewImage(fileField.files);\n\n    if (dt.files.length >= 3) {// dragArea.firstElementChild.textContent = 'これ以上画像を送付できません。';\n    }\n  });\n  clearImagesButton.addEventListener('click', function () {\n    clearImagesButton.style.display = 'none';\n    dt.clearData();\n    fileField.files = dt.files;\n    setPreviewImage(fileField.files);\n    dragArea.firstElementChild.textContent = '送付したい画像を3枚までドラッグ&ドロップ';\n  });\n});\nonPageLoad('articles#show', function () {\n  var fileField = document.getElementById('comment_image');\n  var dragArea = document.getElementById('dragArea');\n  var dt = new DataTransfer();\n  var articleMainImg = document.querySelector('.main_img');\n  var articleSubImgs = document.querySelectorAll('.sub_img');\n  var clearCommentImagesButton = document.getElementById('clearCommentImagesButton');\n  var imageTab = document.querySelector('.image_tab');\n  var framesWrapper = document.querySelector('.frames_wrapper');\n  var mapTab = document.querySelector('.map_tab');\n  var mapInfoWrapper = document.querySelector('.map_info_wrapper');\n  articleSubImgs.forEach(function (img) {\n    img.addEventListener('click', function () {\n      console.log('aaa');\n      articleMainImg.firstElementChild.src = img.getAttribute('data-image-path');\n      articleMainImg.href = img.getAttribute('data-image-path');\n    });\n  });\n  console.log('aaa');\n  fileField.addEventListener('change', function (e) {\n    setPreviewImage(e.target.files);\n\n    if (e.target.files.length > 0) {\n      clearCommentImagesButton.style.display = 'inline-block';\n    }\n  });\n  dragArea.addEventListener('dragover', function (e) {\n    e.preventDefault(); // e.target.style.backgroundColor = 'red';\n  });\n  dragArea.addEventListener('dragleave', function (e) {\n    e.preventDefault(); // e.target.style.backgroundColor = 'pink';\n  });\n  dragArea.addEventListener('drop', function (e) {\n    e.preventDefault(); // e.target.style.backgroundColor = 'pink';\n\n    fileField.files = e.dataTransfer.files;\n    setPreviewImage(fileField.files);\n    console.log(fileField.files);\n\n    if (fileField.files.length > 0) {\n      clearCommentImagesButton.style.display = 'inline-block';\n    }\n  });\n  clearCommentImagesButton.addEventListener('click', function () {\n    dt.clearData();\n    fileField.files = dt.files;\n    setPreviewImage(fileField.files);\n    clearCommentImagesButton.style.display = 'none';\n  });\n  imageTab.addEventListener('click', function () {\n    imageTab.classList.add('selected');\n    framesWrapper.style.display = 'block';\n    mapTab.classList.remove('selected');\n    mapInfoWrapper.style.display = 'none';\n  });\n  mapTab.addEventListener('click', function () {\n    imageTab.classList.remove('selected');\n    framesWrapper.style.display = 'none';\n    mapTab.classList.add('selected');\n    mapInfoWrapper.style.display = 'block';\n  });\n});\nonPageLoad('articles#visitor', function () {\n  var articleMainImg = document.querySelector('.main_img');\n  var articleSubImgs = document.querySelectorAll('.sub_img');\n  var imageTab = document.querySelector('.image_tab');\n  var framesWrapper = document.querySelector('.frames_wrapper');\n  var mapTab = document.querySelector('.map_tab');\n  var mapInfoWrapper = document.querySelector('.map_info_wrapper');\n  articleSubImgs.forEach(function (img) {\n    img.addEventListener('click', function () {\n      console.log('aaa');\n      articleMainImg.firstElementChild.src = img.getAttribute('data-image-path');\n      articleMainImg.href = img.getAttribute('data-image-path');\n    });\n  });\n  imageTab.addEventListener('click', function () {\n    imageTab.classList.add('selected');\n    framesWrapper.style.display = 'block';\n    mapTab.classList.remove('selected');\n    mapInfoWrapper.style.display = 'none';\n  });\n  mapTab.addEventListener('click', function () {\n    imageTab.classList.remove('selected');\n    framesWrapper.style.display = 'none';\n    mapTab.classList.add('selected');\n    mapInfoWrapper.style.display = 'block';\n  });\n});","map":{"version":3,"sources":["/dokotory/app/javascript/packs/article.js"],"names":["onPageLoad","controller_and_actions","callback","document","addEventListener","conditions","regularize","console","error","forEach","a_controller_and_action","split","controller","action","isOnPage","Object","prototype","toString","call","includes","selector","querySelectorAll","length","setPreviewImage","files","i","parentNode","removeChild","file","blobUrl","window","URL","createObjectURL","img","createElement","src","classList","add","dragArea","appendChild","fileField","getElementById","dt","DataTransfer","clearImagesButton","e","target","preventDefault","style","backgroundColor","display","items","dataTransfer","clearData","firstElementChild","textContent","articleMainImg","querySelector","articleSubImgs","clearCommentImagesButton","imageTab","framesWrapper","mapTab","mapInfoWrapper","log","getAttribute","href","remove"],"mappings":"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","sourcesContent":["//==========================================================onPageLoadの定義\n\nfunction onPageLoad(controller_and_actions, callback) {\n  document.addEventListener('turbolinks:load', ()=>{\n    const conditions = regularize(controller_and_actions);\n    if (!conditions) {\n      console.error('[onPageLoad] Unexpected arguments!');\n      return;\n    }\n    conditions.forEach(a_controller_and_action =>{\n      const [controller, action] = a_controller_and_action.split('#');\n      if (isOnPage(controller, action)) {\n        callback();\n      }\n    });\n  });\n}\n\nfunction regularize(controller_and_actions) {\n  if (typeof controller_and_actions == 'string') {\n    return[controller_and_actions];\n  } else if (\n    Object.prototype.toString.call(controller_and_actions).includes('Array')\n    //controller_and_actions.isArray()\n  ) {\n    return controller_and_actions;\n  } else {\n    return null;\n  }\n}\n\nfunction isOnPage(controller, action) {\n  var selector = `body[data-controller='${controller}']`;\n  if (!!action) {\n    selector += `[data-action='${action}']`\n  };\n  return document.querySelectorAll(selector).length > 0;\n}\n\nfunction setPreviewImage(files) {\n  document.querySelectorAll('.previewImage').forEach(i => {\n    i.parentNode.removeChild(i);\n  });\n\n  for(var i = 0; i < files.length; i++) {\n    var file = files[i];\n    var blobUrl = window.URL.createObjectURL(file);\n    var img = document.createElement('img');\n    img.src = blobUrl;\n    img.classList.add('previewImage');\n    // document.body.appendChild(img);\n    dragArea.appendChild(img);\n  }\n}\n//=============================================================\n\nonPageLoad(['articles#new', 'articles#edit'],()=>{\n  var fileField = document.getElementById('article_images');\n  var dragArea = document.getElementById('dragArea');\n  var dt = new DataTransfer(); //iOS,IEでは不可能.\n  var clearImagesButton = document.getElementById('clearImagesButton');\n\n  fileField.addEventListener('change', (e)=>{\n    setPreviewImage(e.target.files);\n  });\n\n  dragArea.addEventListener('dragover',(e)=>{\n    e.preventDefault();\n    e.target.style.backgroundColor = 'rgb(154, 154, 154)';\n  });\n\n  dragArea.addEventListener('dragleave',(e)=>{\n    e.target.style.backgroundColor = 'rgb(231, 231, 231)';\n  });\n\n  dragArea.addEventListener('drop',(e)=>{\n    if (dt.files.length >= 3) {\n      clearImagesButton.style.display = 'inline-block';\n      return;\n    }\n    e.preventDefault();\n    e.target.style.backgroundColor = 'rgb(231, 231, 231)';\n\n    clearImagesButton.style.display = 'inline-block';\n\n    dt.items.add(e.dataTransfer.files[0]);\n    fileField.files = dt.files;\n\n    setPreviewImage(fileField.files);\n\n    if (dt.files.length >= 3) {\n      // dragArea.firstElementChild.textContent = 'これ以上画像を送付できません。';\n    }\n  });\n\n  clearImagesButton.addEventListener('click', ()=>{\n    clearImagesButton.style.display = 'none';\n    dt.clearData();\n    fileField.files = dt.files;\n    setPreviewImage(fileField.files);\n    dragArea.firstElementChild.textContent = '送付したい画像を3枚までドラッグ&ドロップ';\n  });\n});\n\nonPageLoad('articles#show',()=>{\n  var fileField = document.getElementById('comment_image');\n  var dragArea = document.getElementById('dragArea');\n  var dt = new DataTransfer()\n  var articleMainImg = document.querySelector('.main_img');\n  var articleSubImgs = document.querySelectorAll('.sub_img');\n  var clearCommentImagesButton = document.getElementById('clearCommentImagesButton')\n\n  var imageTab = document.querySelector('.image_tab');\n  var framesWrapper = document.querySelector('.frames_wrapper');\n  var mapTab = document.querySelector('.map_tab');\n  var mapInfoWrapper = document.querySelector('.map_info_wrapper');\n\n  articleSubImgs.forEach((img)=>{\n    img.addEventListener('click',()=>{\n      console.log('aaa');\n      articleMainImg.firstElementChild.src = img.getAttribute('data-image-path');\n      articleMainImg.href = img.getAttribute('data-image-path');\n    });\n  });\n\n  console.log('aaa');\n  fileField.addEventListener('change',(e)=>{\n    setPreviewImage(e.target.files)\n    if (e.target.files.length > 0) {\n      clearCommentImagesButton.style.display = 'inline-block';\n    }\n  });\n\n  dragArea.addEventListener('dragover',(e)=>{\n    e.preventDefault();\n    // e.target.style.backgroundColor = 'red';\n  });\n\n  dragArea.addEventListener('dragleave',(e)=>{\n    e.preventDefault();\n    // e.target.style.backgroundColor = 'pink';\n  });\n\n  dragArea.addEventListener('drop',(e)=>{\n    e.preventDefault();\n    // e.target.style.backgroundColor = 'pink';\n    fileField.files = e.dataTransfer.files\n    setPreviewImage(fileField.files);\n\n    console.log(fileField.files);\n\n    if (fileField.files.length > 0) {\n      clearCommentImagesButton.style.display = 'inline-block';\n    }\n  });\n\n  clearCommentImagesButton.addEventListener('click', ()=>{\n    dt.clearData();\n    fileField.files = dt.files\n    setPreviewImage(fileField.files);\n    clearCommentImagesButton.style.display = 'none';\n  });\n\n  imageTab.addEventListener('click',()=>{\n    imageTab.classList.add('selected');\n    framesWrapper.style.display ='block';\n    mapTab.classList.remove('selected');\n    mapInfoWrapper.style.display ='none';\n  });\n\n  mapTab.addEventListener('click',()=>{\n    imageTab.classList.remove('selected');\n    framesWrapper.style.display ='none';\n    mapTab.classList.add('selected');\n    mapInfoWrapper.style.display ='block';\n  });\n});\n\nonPageLoad('articles#visitor',()=>{\n\n  var articleMainImg = document.querySelector('.main_img');\n  var articleSubImgs = document.querySelectorAll('.sub_img');\n\n  var imageTab = document.querySelector('.image_tab');\n  var framesWrapper = document.querySelector('.frames_wrapper');\n  var mapTab = document.querySelector('.map_tab');\n  var mapInfoWrapper = document.querySelector('.map_info_wrapper');\n\n  articleSubImgs.forEach((img)=>{\n    img.addEventListener('click',()=>{\n      console.log('aaa');\n      articleMainImg.firstElementChild.src = img.getAttribute('data-image-path');\n      articleMainImg.href = img.getAttribute('data-image-path');\n    });\n  });\n\n  imageTab.addEventListener('click',()=>{\n    imageTab.classList.add('selected');\n    framesWrapper.style.display ='block';\n    mapTab.classList.remove('selected');\n    mapInfoWrapper.style.display ='none';\n  });\n\n  mapTab.addEventListener('click',()=>{\n    imageTab.classList.remove('selected');\n    framesWrapper.style.display ='none';\n    mapTab.classList.add('selected');\n    mapInfoWrapper.style.display ='block';\n  });\n});\n"]},"metadata":{},"sourceType":"module"}